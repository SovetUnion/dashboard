"use strict";(globalThis["webpackChunkgetpay"]=globalThis["webpackChunkgetpay"]||[]).push([[202],{7202:(e,l,a)=>{a.r(l),a.d(l,{default:()=>R});var t=a(9835),o=a(6970);const s=(0,t._)("div",{class:"col-2 q-table__title"},"Media",-1),i=(0,t._)("div",{class:"text-h6"},"Upload File",-1),d=(0,t._)("div",{class:"text-subtitle"},"Upload or Drag & Drop your file here",-1),r=(0,t.Uk)("Close"),n=(0,t._)("div",{class:"text-h6"},"Edit File",-1),u=(0,t._)("div",{class:"text-subtitle"},"Upload or Drag & Drop your file here",-1),c=(0,t.Uk)("Close");function p(e,l,a,p,m,f){const g=(0,t.up)("q-space"),h=(0,t.up)("q-btn"),w=(0,t.up)("q-img"),_=(0,t.up)("q-td"),b=(0,t.up)("q-tr"),W=(0,t.up)("q-table"),U=(0,t.up)("q-card-section"),k=(0,t.up)("q-separator"),y=(0,t.up)("q-uploader"),D=(0,t.up)("q-card-actions"),q=(0,t.up)("q-card"),v=(0,t.up)("q-dialog"),x=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(x,{class:"q-pa-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{rows:e.rows,columns:e.columns},{top:(0,t.w5)((()=>[s,(0,t.Wm)(g),(0,t.Wm)(h,{color:"primary",rounded:"",label:"Upload",size:"sm",onClick:l[0]||(l[0]=l=>e.uploadDialog=!0)})])),body:(0,t.w5)((l=>[(0,t.Wm)(b,{props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{key:"file",props:l},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{src:e.baseUrl+l.row.file,width:"100",height:"100"},null,8,["src"])])),_:2},1032,["props"]),(0,t.Wm)(_,{key:"date_created",props:l},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$formatDate(l.row.date_created)),1)])),_:2},1032,["props"]),(0,t.Wm)(_,{key:"date_updated",props:l},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.$formatDate(l.row.date_updated)),1)])),_:2},1032,["props"]),(0,t.Wm)(_,{key:"actions",props:l,class:"q-gutter-sm"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{label:"Edit",outline:"",color:"primary",icon:"edit",onClick:a=>e.edit(l.row),size:"sm"},null,8,["onClick"]),(0,t.Wm)(h,{label:"Remove",outline:"",color:"red",icon:"delete",onClick:a=>e.remove(l.row),size:"sm"},null,8,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["rows","columns"]),(0,t.Wm)(v,{modelValue:e.uploadDialog,"onUpdate:modelValue":l[2]||(l[2]=l=>e.uploadDialog=l),persistent:""},{default:(0,t.w5)((()=>[(0,t.Wm)(q,null,{default:(0,t.w5)((()=>[(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[i,d])),_:1}),(0,t.Wm)(k),(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[(0,t.Wm)(y,{label:"Select File",url:e.baseUrl+"/v1/media/","field-name":"file",accept:".jpg, .jpeg, .png, .webp","max-file-size":"7000000","max-files":"1",headers:[{name:"Authorization",value:"Bearer "+e.accessToken}],onRejected:e.fileRejected,onUploaded:e.fileUploaded,onFailed:e.uploadFailed},null,8,["url","headers","onRejected","onUploaded","onFailed"])])),_:1}),(0,t.Wm)(D,null,{default:(0,t.w5)((()=>[(0,t.Wm)(h,{class:"full-width",color:"primary",size:"sm",outline:"",onClick:l[1]||(l[1]=l=>e.uploadDialog=!1)},{default:(0,t.w5)((()=>[r])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(v,{modelValue:e.editDialog,"onUpdate:modelValue":l[4]||(l[4]=l=>e.editDialog=l),persistent:""},{default:(0,t.w5)((()=>[(0,t.Wm)(q,null,{default:(0,t.w5)((()=>[(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[n,u])),_:1}),(0,t.Wm)(k),(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,{src:e.baseUrl+e.row.file,width:"100",height:"100"},null,8,["src"]),(0,t.Wm)(y,{ref:"editUploader",label:"Select File",url:e.baseUrl+`/v1/media/${e.row.id}`,"field-name":"file",accept:".jpg, .jpeg, .png, .webp","max-file-size":"7000000","max-files":"1",headers:[{name:"Authorization",value:"Bearer "+e.accessToken}],onRejected:e.fileRejected,onUploaded:e.fileUpdated,onFailed:e.uploadFailed},null,8,["url","headers","onRejected","onUploaded","onFailed"])])),_:1}),(0,t.Wm)(D,null,{default:(0,t.w5)((()=>[(0,t.Wm)(h,{class:"full-width",color:"primary",size:"sm",outline:"",onClick:l[3]||(l[3]=l=>e.editDialog=!1)},{default:(0,t.w5)((()=>[c])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var m=a(499),f=a(2502),g=a(6928),h=a(963);const w=(0,t.aZ)({name:"MediaPage",preFetch(){const e=(0,g.t)(),l=(0,h.Z)();return e.axios.get("/media/").then((e=>{l.setMedia(e.data.data)})).catch((e=>{console.log(e)}))},setup(){const{baseUrl:e,accessToken:l}=(0,g.t)(),{media:a,currentRow:t}=(0,f.Jk)((0,h.Z)());return{baseUrl:e,accessToken:l,row:t,uploadDialog:(0,m.iH)(!1),editDialog:(0,m.iH)(!1),rows:a,columns:[{name:"file",label:"File",field:"file",align:"left"},{name:"date_created",label:"Date Created",field:"date_created",align:"left"},{name:"date_updated",label:"Date Updated",field:"date_updated",align:"left"},{name:"actions",field:"actions",label:"Actions",align:"left"}]}},methods:{fileRejected(e){this.$q.notify({color:"warning",message:"Files rejected. Our server only supports files (.jpg, .png and .webp) and the maximum file size is 7MB"})},fileUploaded(e){const{xhr:l}=e,{color:a,message:t}=this._getDefaultMessage(l,"File uploaded successfully");if(200==l.status){const e=JSON.parse(l.responseText);this.rows.unshift(e)}this.$q.notify({color:a,message:t})},fileUpdated(e){const{xhr:l}=e,{color:a,message:t}=this._getDefaultMessage(l,"File updated successfully");if(200==l.status){const e=JSON.parse(l.responseText);let a=(Math.random()+1).toString(36).substring(7);e["file"]=e.file+"?id="+a,this.rows=this.rows.map((l=>l.id==e.id?e:l))}this.$q.notify({color:a,message:t})},uploadFailed(e){const{xhr:l}=e,{color:a,message:t}=this._getDefaultMessage(l,"Oops! There is something wrong with your server");this.$q.notify({color:a,message:t})},_getDefaultMessage(e,l){var a="positive";const{detail:t}=JSON.parse(e.responseText);if(400==e.status&&"Token has expired"==t){l="Needs Re-Authentication",a="negative";const e=(0,g.t)();setTimeout((()=>{e.logout()}),1500)}return{color:a,message:l}},remove(e){this.$q.dialog({title:"Delete Media",message:"Are you sure you want to delete this media?",cancel:!0,persistent:!0}).onOk((()=>{const l=(0,g.t)();l.axios.delete(`/media/${e.id}`).then((l=>{l.data.success&&(this.rows=this.rows.filter((l=>l.id!==e.id)),this.$q.notify({color,message:"File Removed"}))})).catch((e=>{console.log(e),this.$q.notify({color:"negative",text:"Failed to remove file"})}))}))},edit(e){const l=(0,h.Z)();l.setCurrentRow(e),this.editDialog=!0}}});var _=a(1639),b=a(9885),W=a(7580),U=a(136),k=a(4455),y=a(9546),D=a(7220),q=a(335),v=a(2074),x=a(4458),F=a(3190),Z=a(926),C=a(7534),T=a(1821),j=a(9984),Q=a.n(j);const z=(0,_.Z)(w,[["render",p]]),R=z;Q()(w,"components",{QPage:b.Z,QTable:W.Z,QSpace:U.Z,QBtn:k.Z,QTr:y.Z,QTd:D.Z,QImg:q.Z,QDialog:v.Z,QCard:x.Z,QCardSection:F.Z,QSeparator:Z.Z,QUploader:C.Z,QCardActions:T.Z})}}]);